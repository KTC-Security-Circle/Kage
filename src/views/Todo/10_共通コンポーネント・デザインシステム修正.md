# 10. 共通コンポーネント・デザインシステム修正

## 現状の問題点

src/views_new 全体で、テンプレートのデザインシステムと以下の点で乖離している：

### 1. デザイントークンの不統一

**テンプレート**：
- 統一されたカラーパレット（neutral-50, slate-200, blue-600等）
- 一貫したスペーシング値（gap-3, p-6, space-y-6等）
- 統一されたボーダー半径、シャドウ

**現状**：
- Fletデフォルトのデザイントークン使用
- theme.pyでの部分的実装のみ（すべて置き換えする）

### 2. 再利用可能コンポーネントの不足

**テンプレート**：
- Card（統一されたカードレイアウト）
- Badge（ステータス表示）
- Button（アクションボタン）
- Input（検索フィールド等）
- Progress（プログレスバー）
- Tabs（タブシステム）

**現状**：
- 基本的なFletコンポーネントのみ
- カスタムコンポーネントが不足

### 3. アイコンシステム

**テンプレート**：
- lucide-reactアイコンの統一使用
- 適切なサイズ指定（size-4, size-5等）
- 一貫したアイコン選択

**現状**：
- Fletアイコンの基本使用
- アイコンサイズの不統一

### 4. レスポンシブデザイン

**テンプレート**：
- lg:grid-cols-3等のレスポンシブクラス
- モバイル対応のレイアウト調整
- 適切なブレークポイント設定

**現状**：
- デスクトップ中心の設計
- レスポンシブ対応が不十分

### 5. 状態管理とフィードバック

**テンプレート**：
- ホバー効果（hover:border-neutral-300）
- 選択状態（border-blue-500, shadow-md）
- ローディング状態
- エラー状態

**現状**：
- 基本的な状態表現のみ
- 視覚的フィードバックが不足

## 修正箇所

### 1. デザイントークンの拡張

```python
# theme.py の拡張：

# カラーパレット
COLORS = {
    'neutral': {
        50: '#fafafa',
        100: '#f5f5f5', 
        200: '#e5e5e5',
        600: '#525252',
        # ...
    },
    'blue': {
        50: '#eff6ff',
        500: '#3b82f6',
        600: '#2563eb',
        # ...
    },
    'slate': {
        200: '#e2e8f0',
        900: '#0f172a',
        # ...
    }
}

# スペーシング
SPACING = {
    'xs': 4,
    'sm': 8,
    'md': 16,
    'lg': 24,
    'xl': 32,
    # ...
}

# ボーダー半径
BORDER_RADIUS = {
    'sm': 4,
    'md': 8,
    'lg': 12,
    # ...
}
```

### 2. 共通コンポーネントの作成

```python
# shared/components/card.py
class Card(ft.Container):
    """統一されたカードコンポーネント"""
    
# shared/components/badge.py  
class Badge(ft.Container):
    """ステータス表示バッジ"""
    
# shared/components/button.py
class Button(ft.ElevatedButton):
    """統一されたボタン"""
    
# shared/components/input.py
class SearchInput(ft.TextField):
    """検索入力フィールド"""
    
# shared/components/progress.py
class Progress(ft.Container):
    """プログレスバー"""
    
# shared/components/tabs.py
class TabSystem(ft.Container):
    """カスタムタブシステム"""
```

### 3. アイコンマッピングシステム

```python
# shared/icons.py
ICON_MAP = {
    'home': ft.Icons.HOME,
    'file_text': ft.Icons.DESCRIPTION,
    'check_square': ft.Icons.CHECK_BOX,
    'folder_open': ft.Icons.FOLDER_OPEN,
    'tag': ft.Icons.LOCAL_OFFER,
    'book_open': ft.Icons.MENU_BOOK,
    'calendar_check': ft.Icons.EVENT_AVAILABLE,
    'settings': ft.Icons.SETTINGS,
    'search': ft.Icons.SEARCH,
    'plus': ft.Icons.ADD,
    # lucide-reactアイコンの対応マッピング
}

def get_icon(name: str, size: int = 24) -> ft.Icon:
    """統一されたアイコン取得"""
    return ft.Icon(ICON_MAP.get(name, ft.Icons.HELP), size=size)
```

### 4. レスポンシブヘルパー

```python
# shared/responsive.py
class ResponsiveLayout:
    """レスポンシブレイアウトヘルパー"""
    
    @staticmethod
    def get_columns_count(page_width: float) -> int:
        """画面幅に応じたカラム数を取得"""
        if page_width < 768:  # mobile
            return 1
        elif page_width < 1024:  # tablet
            return 2
        else:  # desktop
            return 3
```

### 5. 状態管理コンポーネント

```python
# shared/components/interactive.py
class InteractiveCard(ft.Container):
    """ホバー・選択状態を持つカード"""
    
    def __init__(self, 
                 content: ft.Control,
                 selected: bool = False,
                 on_click: callable = None,
                 **kwargs):
        # ホバー効果と選択状態の実装
        
class StatusBadge(ft.Container):
    """ステータス別の色分けバッジ"""
    
    def __init__(self, 
                 text: str,
                 status: str,  # 'success', 'warning', 'error', 'info'
                 **kwargs):
        # ステータス別色分けの実装
```

### 6. 統一されたレイアウトパターン

```python
# shared/layouts.py
class TwoPane(ft.Container):
    """2ペインレイアウト"""
    
class ThreePane(ft.Container):
    """3ペインレイアウト"""
    
class HeaderContentLayout(ft.Column):
    """ヘッダー+コンテンツレイアウト"""
```

### 7. フォームコンポーネント

```python
# shared/components/form.py
class FormField(ft.Column):
    """統一されたフォームフィールド"""
    
class FormSection(ft.Card):
    """フォームセクション"""
```

### 8. 空状態コンポーネント

```python
# shared/components/empty_state.py
class EmptyState(ft.Container):
    """空状態表示"""
    
    def __init__(self,
                 icon: str,
                 title: str,
                 description: str,
                 action_button: ft.Control = None,
                 **kwargs):
        # 統一された空状態表示
```

## デザイン原則

### 1. 一貫性
- すべてのコンポーネントで同じデザイントークンを使用
- アイコンサイズとスタイルの統一
- カラーパレットの厳格な適用

### 2. 再利用性
- コンポーネント化による保守性向上
- プロパティによるカスタマイズ対応
- 継承による拡張性確保

### 3. レスポンシブ対応
- モバイルファーストの設計
- 適切なブレークポイント設定
- 柔軟なレイアウト調整

### 4. アクセシビリティ
- 適切なコントラスト比
- キーボードナビゲーション対応
- スクリーンリーダー対応

## 優先度
**最高** - 全ページの統一感に直接影響

## 影響範囲
- 全画面のデザイン統一
- 保守性の向上
- 開発効率の改善

## 作業見積もり
約6-8時間（デザインシステム全体の構築含む）

## 依存関係
- 全画面修正の基盤となる
- テンプレート解析の完了
- デザイントークンの仕様確定